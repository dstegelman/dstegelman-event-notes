

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Web Server Bottlenecks And Performance Tuning &mdash; Conference Notes and Best Practices 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="Conference Notes and Best Practices 1.0 documentation" href="../../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../../../index.html">Conference Notes and Best Practices 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="web-server-bottlenecks-and-performance-tuning">
<h1>Web Server Bottlenecks And Performance Tuning<a class="headerlink" href="#web-server-bottlenecks-and-performance-tuning" title="Permalink to this headline">¶</a></h1>
<p><strong>Presenter:</strong> Graham Dumpleton</p>
<p><strong>Track:</strong> V</p>
<p><strong>Description:</strong></p>
<blockquote>
<div><p>New Python web developers seem to love running benchmarks on WSGI servers. Reality is that they often have no idea what they are doing or what to look at. This talk will look at a range of factors which can influence the performance of your Python web application. This includes the impact of using threads vs processes, number of processors, memory available, the GIL and slow HTTP clients.</p>
<p><a class="reference external" href="https://us.pycon.org/2012/schedule/presentation/275/">https://us.pycon.org/2012/schedule/presentation/275/</a></p>
</div></blockquote>
<div class="section" id="big-picture">
<h2>Big Picture<a class="headerlink" href="#big-picture" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Many moving parts in the whole system</li>
<li>Main User grief is on teh front end. (Static, Network isues)</li>
<li>80% - 90% of the end user reponse time is spent on the front end.  Start There.</li>
<li>Database/Application Server</li>
</ul>
<div class="section" id="are-benchmarks-stupid">
<h3>Are Benchmarks Stupid<a class="headerlink" href="#are-benchmarks-stupid" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Little value</li>
<li>People reference them, and they are often wrong</li>
<li>Test only a single narrow use case.</li>
<li>Hitting a site with extram load will only show you whtat i till likely fail under a denial of service attack.</li>
<li>Should test corner cases, typical use cases</li>
</ul>
</div>
</div>
<div class="section" id="environment">
<h2>Environment<a class="headerlink" href="#environment" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Memory</li>
<li>Processors</li>
<li>Threads</li>
<li>Golbal Interpreter Lock</li>
</ul>
<div class="section" id="client-impacts">
<h3>Client Impacts<a class="headerlink" href="#client-impacts" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Slow HTTP Browsers/clients</li>
<li>Need to handle static assets ( Don&#8217;t use same server )</li>
</ul>
</div>
</div>
<div class="section" id="use-cases">
<h2>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Memory USage</li>
<li>Threads</li>
<li>Long Running Requests</li>
<li>HTTP Clients</li>
</ul>
<div class="section" id="memory-usage">
<h3>Memory Usage<a class="headerlink" href="#memory-usage" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Web server base memory usage</li>
<li>Web server per thrad memory usage</li>
<li>Application base memory usage</li>
<li>Loaded before forking?</li>
<li>Adding more processes increases memory quicker.</li>
<li>Issue is mainly about configuration</li>
<li>Change and evaluate what your config is, don&#8217;t just use the defaults.</li>
<li>Number of overall threads, dictated by overall concurrent users.</li>
</ul>
</div>
<div class="section" id="threads">
<h3>Threads<a class="headerlink" href="#threads" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>More processes, more memory</li>
<li>Find a balance</li>
<li>If CPU is slow, more processes</li>
<li>IO Wait</li>
</ul>
</div>
<div class="section" id="long-running-request">
<h3>Long Running Request<a class="headerlink" href="#long-running-request" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Uploads</li>
<li>Slow HTTP</li>
<li>Large Response</li>
</ul>
</div>
<div class="section" id="slow-http-clients">
<h3>Slow HTTP Clients<a class="headerlink" href="#slow-http-clients" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Proxy NGINX with Gunicorn</li>
<li>Offload static</li>
<li>Put Nginx in front of apache workers -&gt; mod_wsgi dameons</li>
</ul>
</div>
<div class="section" id="restarts">
<h3>Restarts<a class="headerlink" href="#restarts" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Restarts to fix issues</li>
<li>Reloading of the application</li>
<li>Requests continue to backload</li>
<li>Should do a full shut down if backlog cannot be cleared.</li>
</ul>
</div>
<div class="section" id="pre-load-everything">
<h3>Pre load Everything<a class="headerlink" href="#pre-load-everything" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Load maximum processes into server at the begninng</li>
<li>No auto scaling</li>
</ul>
</div>
<div class="section" id="horizontal-scaling">
<h3>Horizontal Scaling<a class="headerlink" href="#horizontal-scaling" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Use more servers</li>
</ul>
<p><tt class="docutils literal"><span class="pre">If</span> <span class="pre">you</span> <span class="pre">treat</span> <span class="pre">your</span> <span class="pre">server</span> <span class="pre">like</span> <span class="pre">a</span> <span class="pre">black</span> <span class="pre">box</span> <span class="pre">you</span> <span class="pre">will</span> <span class="pre">never</span> <span class="pre">know</span> <span class="pre">what</span> <span class="pre">is</span> <span class="pre">going</span> <span class="pre">on.</span></tt></p>
</div>
</div>
<div class="section" id="tools">
<h2>Tools<a class="headerlink" href="#tools" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>New Relic</li>
<li>Sentry - Captures errors, but not performance problems</li>
</ul>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Don&#8217;t trust server defaults</li>
<li>Monitor live production systems</li>
<li>Use benchmarks to explore a specific system, not to compare different systems.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Web Server Bottlenecks And Performance Tuning</a><ul>
<li><a class="reference internal" href="#big-picture">Big Picture</a><ul>
<li><a class="reference internal" href="#are-benchmarks-stupid">Are Benchmarks Stupid</a></li>
</ul>
</li>
<li><a class="reference internal" href="#environment">Environment</a><ul>
<li><a class="reference internal" href="#client-impacts">Client Impacts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#use-cases">Use Cases</a><ul>
<li><a class="reference internal" href="#memory-usage">Memory Usage</a></li>
<li><a class="reference internal" href="#threads">Threads</a></li>
<li><a class="reference internal" href="#long-running-request">Long Running Request</a></li>
<li><a class="reference internal" href="#slow-http-clients">Slow HTTP Clients</a></li>
<li><a class="reference internal" href="#restarts">Restarts</a></li>
<li><a class="reference internal" href="#pre-load-everything">Pre load Everything</a></li>
<li><a class="reference internal" href="#horizontal-scaling">Horizontal Scaling</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tools">Tools</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/conferences/pycon2012/saturday/server_bottlenecks.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../../../index.html">Conference Notes and Best Practices 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Derek Stegelman.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>